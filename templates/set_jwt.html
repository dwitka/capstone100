<html>
	<head>
		<title>Set JWT Page</title>
	</head>
	<body>
		<form id='form'>
			<input type="text" id="token" name="token"/>
			<input type="submit" value="Add Token"/>
		</form>
		<a href="https://capstone100.herokuapp.com/render_page">Continue</a>
                <script>
                    function get_token () {
                        var myUrl = window.location + '';
			var sub_token = myUrl.split('=')[1];
			var token = sub_token.split('&')[0];
                        return token;
                    };
                    
                    function parseJwt (token) {
                        var base64Url = token.split('.')[1];
                        var base64 = decodeURIComponent(atob(base64Url).split('').map((c)=>{
                        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                        }).join(''));
                    
                        return JSON.parse(base64);
                    };
		    /*const data = parseJwt(get_token);*/
		    document.getElementById('form').onSubmit = function(e) {
			e.preventDefault();

		    fetch('/render_page', {
    			method: 'POST',
			headers: {
			    'Content-Type': 'application/json'
    			},
    		    	body: JSON.stringify({
			    'jwt': document.getElementById('token').value
			})
		    })
		    .then(response => response.json())
		    .then(jsonResponse => {
			console.log('Success:', jsonResponse);
		    })
		    .catch((error) => {
			console.error('Error:', error);
		    });
		    }
                </script>
	</body>
</html>
